#!/usr/bin/python
# op-firewall - GPL - Copyright 2016 - Oddcoder
import r2pipe as r2
import shellcode
def pdf(hexstr):
    r = r2.open ("malloc://0x400")
    r.cmd ("wx " + hexstr)
    r.cmd ("aaa")
    x = r.cmd ("pD " + str (len (hexstr) / 2))
    if x[0] == '0':
        print "\t    " + x
    else:
        print "\t" + x
    r.quit ()

print "\n## Finder shellcode"
pdf (shellcode.finder.encode ("hex"))

print "\n## Decoder shellcode"
pdf (shellcode.decoder.encode ("hex"))

print "\n## Execute_post shellcode"
pdf (shellcode.execute_post.encode ("hex"))

print "\n## Probe shellcode"
pdf (shellcode.probe.encode ("hex"))
